<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pyxem.utils package &#8212; pyXem 0.7.1 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="pyxem.tests.test_utils package" href="pyxem.tests.test_utils.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          pyXem</a>
        <span class="navbar-text navbar-version pull-left"><b>0.7.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">pyXem - Crystallographic Electron Microscopy in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html">Contents</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pyxem</a></li>
<li class="toctree-l1"><a class="reference internal" href="literature.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">pyxem.utils package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.atomic_scattering_params">pyxem.utils.atomic_scattering_params module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.expt_utils">pyxem.utils.expt_utils module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.indexation_utils">pyxem.utils.indexation_utils module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.lobato_scattering_params">pyxem.utils.lobato_scattering_params module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.peakfinder2D_gui">pyxem.utils.peakfinder2D_gui module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.peakfinders2D">pyxem.utils.peakfinders2D module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.plot">pyxem.utils.plot module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.scattering_params">pyxem.utils.scattering_params module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.sim_utils">pyxem.utils.sim_utils module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.subpixel_refinements_utils">pyxem.utils.subpixel_refinements_utils module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.vdf_utils">pyxem.utils.vdf_utils module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils.vector_utils">pyxem.utils.vector_utils module</a></li>
<li><a class="reference internal" href="#module-pyxem.utils">Module contents</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="pyxem.tests.test_utils.html" title="Previous Chapter: pyxem.tests.test_utils package"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; pyxem.tests.t...</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="pyxem-utils-package">
<h1>pyxem.utils package<a class="headerlink" href="#pyxem-utils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyxem.utils.atomic_scattering_params">
<span id="pyxem-utils-atomic-scattering-params-module"></span><h2>pyxem.utils.atomic_scattering_params module<a class="headerlink" href="#module-pyxem.utils.atomic_scattering_params" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyxem.utils.expt_utils">
<span id="pyxem-utils-expt-utils-module"></span><h2>pyxem.utils.expt_utils module<a class="headerlink" href="#module-pyxem.utils.expt_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyxem.utils.expt_utils.affine_transformation">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">affine_transformation</code><span class="sig-paren">(</span><em>z</em>, <em>transformation</em>, <em>order</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#affine_transformation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.affine_transformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply an affine transformation to a 2-dimensional array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em>) – Array to be transformed</p></li>
<li><p><strong>matrix</strong> (<em>np.array</em>) – 3x3 numpy array specifying the affine transformation to be applied.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Interpolation order.</p></li>
<li><p><strong>*args</strong> – To be passed to skimage.warp</p></li>
<li><p><strong>**kwargs</strong> – To be passed to skimage.warp</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>trans</strong> – Affine transformed diffraction pattern.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.circular_mask">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">circular_mask</code><span class="sig-paren">(</span><em>shape</em>, <em>radius</em>, <em>center=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#circular_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.circular_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a mask of radius ‘r’ centered on ‘center’ of shape ‘shape’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – The shape of the signal to be masked.</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The radius of the circular mask.</p></li>
<li><p><strong>center</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em> (</em><em>optional</em><em>)</em>) – The center of the circular mask. Default: (0, 0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mask</strong> – The circular mask.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.find_beam_offset_cross_correlation">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">find_beam_offset_cross_correlation</code><span class="sig-paren">(</span><em>z</em>, <em>radius_start=4</em>, <em>radius_finish=8</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#find_beam_offset_cross_correlation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.find_beam_offset_cross_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to center the direct beam center by a cross-correlation algorithm.
The shift is calculated relative to an circle perimeter. The circle can be
refined across a range of radii during the centring procedure to improve
performance in regions where the direct beam size changes,
e.g. during sample thickness variation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The lower bound for the radius of the central disc to be used in the
alignment.</p></li>
<li><p><strong>radius_finish</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The upper bounds for the radius of the central disc to be used in the
alignment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>shift</strong> – np.array containing offset (from center) of the direct beam positon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.gain_normalise">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">gain_normalise</code><span class="sig-paren">(</span><em>z</em>, <em>dref</em>, <em>bref</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#gain_normalise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.gain_normalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply gain normalization to experimentally acquired electron
diffraction pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em><em>(</em><em>)</em>) – Two-dimensional data array containing signal.</p></li>
<li><p><strong>dref</strong> (<a class="reference internal" href="pyxem.signals.html#pyxem.signals.electron_diffraction.ElectronDiffraction" title="pyxem.signals.electron_diffraction.ElectronDiffraction"><em>ElectronDiffraction</em></a>) – Two-dimensional data array containing dark reference.</p></li>
<li><p><strong>bref</strong> (<a class="reference internal" href="pyxem.signals.html#pyxem.signals.electron_diffraction.ElectronDiffraction" title="pyxem.signals.electron_diffraction.ElectronDiffraction"><em>ElectronDiffraction</em></a>) – Two-dimensional data array containing bright reference.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>z1</strong> – Two dimensional data array of gain normalized z.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.peaks_as_gvectors">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">peaks_as_gvectors</code><span class="sig-paren">(</span><em>z</em>, <em>center</em>, <em>calibration</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#peaks_as_gvectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.peaks_as_gvectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts peaks found as array indices to calibrated units, for use in a
hyperspy map function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>numpy array</em>) – peak postitions as array indices.</p></li>
<li><p><strong>center</strong> (<em>numpy array</em>) – diffraction pattern center in array indices.</p></li>
<li><p><strong>calibration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – calibration in reciprocal Angstroms per pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>g</strong> – peak positions in calibrated units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.radial_average">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">radial_average</code><span class="sig-paren">(</span><em>z</em>, <em>mask=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#radial_average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.radial_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the radial profile by azimuthal averaging about a specified
center.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em><em>(</em><em>)</em>) – Two-dimensional data array containing signal.</p></li>
<li><p><strong>mask</strong> (<em>np.array</em><em>(</em><em>)</em>) – Array with the same dimensions as z comprizing 0s for excluded pixels
and 1s for non-excluded pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>radial_profile</strong> – One-dimensional radial profile of z.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.reference_circle">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">reference_circle</code><span class="sig-paren">(</span><em>coords</em>, <em>dimX</em>, <em>dimY</em>, <em>radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#reference_circle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.reference_circle" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw the perimeter of an circle at a given position in the diffraction
pattern (e.g. to provide a reference for finding the direct beam center).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.array size n</em><em>,</em><em>2</em>) – size n,2 array of coordinates to draw the circle.</p></li>
<li><p><strong>dimX</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – first dimension of the diffraction pattern (size)</p></li>
<li><p><strong>dimY</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – second dimension of the diffraction pattern (size)</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – radius of the circle to be drawn</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>img</strong> – Array containing the circle at the position given in the coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.regional_filter">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">regional_filter</code><span class="sig-paren">(</span><em>z</em>, <em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#regional_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.regional_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a h-dome regional filtering of the an image for background
subtraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – h-dome cutoff value.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>h-dome subtracted image as np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.remove_dead">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">remove_dead</code><span class="sig-paren">(</span><em>z</em>, <em>deadpixels</em>, <em>deadvalue='average'</em>, <em>d=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#remove_dead"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.remove_dead" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove dead pixels from experimental electron diffraction patterns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em><em>(</em><em>)</em>) – Two-dimensional data array containing signal.</p></li>
<li><p><strong>deadpixels</strong> (<em>np.array</em><em>(</em><em>)</em>) – Array containing the array indices of dead pixels in the diffraction
pattern.</p></li>
<li><p><strong>deadvalue</strong> (<em>string</em>) – <dl class="simple">
<dt>Specify how deadpixels should be treated, options are;</dt><dd><p>’average’: takes the average of adjacent pixels
‘nan’:  sets the dead pixel to nan</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>img</strong> – Two-dimensional data array containing z with dead pixels removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.subtract_background_dog">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">subtract_background_dog</code><span class="sig-paren">(</span><em>z</em>, <em>sigma_min</em>, <em>sigma_max</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#subtract_background_dog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.subtract_background_dog" title="Permalink to this definition">¶</a></dt>
<dd><p>Difference of gaussians method for background removal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Large gaussian blur sigma.</p></li>
<li><p><strong>sigma_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Small gaussian blur sigma.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Denoised diffraction pattern as np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.subtract_background_median">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">subtract_background_median</code><span class="sig-paren">(</span><em>z</em>, <em>footprint=19</em>, <em>implementation='scipy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#subtract_background_median"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.subtract_background_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove background using a median filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>footprint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – size of the window that is convoluted with the array to determine
the median. Should be large enough that it is about 3x as big as the
size of the peaks.</p></li>
<li><p><strong>implementation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – One of ‘scipy’, ‘skimage’. Skimage is much faster, but it messes with
the data format. The scipy implementation is safer, but slower.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pattern with background subtracted as np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.expt_utils.subtract_reference">
<code class="descclassname">pyxem.utils.expt_utils.</code><code class="descname">subtract_reference</code><span class="sig-paren">(</span><em>z</em>, <em>bg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/expt_utils.html#subtract_reference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.expt_utils.subtract_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts background using a user-defined background pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em><em>(</em><em>)</em>) – Two-dimensional data array containing signal.</p></li>
<li><p><strong>bg</strong> (<em>array</em><em>(</em><em>)</em>) – User-defined diffraction pattern to be subtracted as background.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>im</strong> – Two-dimensional data array containing signal with background removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyxem.utils.indexation_utils">
<span id="pyxem-utils-indexation-utils-module"></span><h2>pyxem.utils.indexation_utils module<a class="headerlink" href="#module-pyxem.utils.indexation_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyxem.utils.indexation_utils.correlate_library">
<code class="descclassname">pyxem.utils.indexation_utils.</code><code class="descname">correlate_library</code><span class="sig-paren">(</span><em>image</em>, <em>library</em>, <em>n_largest</em>, <em>mask</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/indexation_utils.html#correlate_library"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.indexation_utils.correlate_library" title="Permalink to this definition">¶</a></dt>
<dd><p>Correlates all simulated diffraction templates in a DiffractionLibrary
with a particular experimental diffraction pattern (image).</p>
<p>Calculated using the normalised (see return type documentation) dot
product, or cosine distance,</p>
<div class="math notranslate nohighlight">
\[\frac{\sum_{j=1}^m P(x_j, y_j) T(x_j, y_j)}{\sqrt{\sum_{j=1}^m T^2(x_j, y_j)}}\]</div>
<p>for a template T and an experimental pattern P.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy.array</em>) – The experimental diffraction pattern of interest.</p></li>
<li><p><strong>library</strong> (<a class="reference internal" href="pyxem.libraries.html#pyxem.libraries.diffraction_library.DiffractionLibrary" title="pyxem.libraries.diffraction_library.DiffractionLibrary"><em>DiffractionLibrary</em></a>) – The library of diffraction simulations to be correlated with the
experimental data.</p></li>
<li><p><strong>n_largest</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of well correlated simulations to be retained.</p></li>
<li><p><strong>mask</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – A mask for navigation axes. 1 indicates positions to be indexed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>top_matches</strong> – Array of shape (&lt;num phases&gt;*n_largest, 3) containing the top n
correlated simulations for the experimental pattern of interest, where
each entry is on the form [phase index, [z, x, z], correlation].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">IndexationGenerator.correlate()</span></code></p>
</div>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>Correlation results are defined as,</dt><dd><dl class="simple">
<dt>phase_index<span class="classifier">int</span></dt><dd><p>Index of the phase, following the ordering of the library keys</p>
</dd>
<dt>[z, x, z]<span class="classifier">ndarray</span></dt><dd><p>numpy array of three floats, specifying the orientation in the
Bunge convention, in degrees.</p>
</dd>
<dt>correlation<span class="classifier">float</span></dt><dd><p>A coefficient of correlation, only normalised to the template
intensity. This is in contrast to the reference work.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<ol class="upperalpha simple" start="5">
<li><p>F. Rauch and L. Dupuy, “Rapid Diffraction Patterns identification through
template matching,” vol. 50, no. 1, pp. 87–99, 2005.</p></li>
</ol>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.indexation_utils.crystal_from_template_matching">
<code class="descclassname">pyxem.utils.indexation_utils.</code><code class="descname">crystal_from_template_matching</code><span class="sig-paren">(</span><em>z_matches</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/indexation_utils.html#crystal_from_template_matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.indexation_utils.crystal_from_template_matching" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes template matching results for a single navigation position and
returns the best matching phase and orientation with correlation and
reliability to define a crystallographic map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z_matches</strong> (<em>numpy.array</em>) – Template matching results in an array of shape (m,3) sorted by
correlation (descending) within each phase, with entries
[phase, [z, x, z], correlation]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results_array</strong> – Crystallographic mapping results in an array of shape (3) with entries
[phase, np.array((z, x, z)), dict(metrics)]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.indexation_utils.crystal_from_vector_matching">
<code class="descclassname">pyxem.utils.indexation_utils.</code><code class="descname">crystal_from_vector_matching</code><span class="sig-paren">(</span><em>z_matches</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/indexation_utils.html#crystal_from_vector_matching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.indexation_utils.crystal_from_vector_matching" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes vector matching results for a single navigation position and
returns the best matching phase and orientation with correlation and
reliability to define a crystallographic map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z_matches</strong> (<em>numpy.array</em>) – Template matching results in an array of shape (m,5) sorted by
total_error (ascending) within each phase, with entries
[phase, R, match_rate, ehkls, total_error]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>results_array</strong> – Crystallographic mapping results in an array of shape (3) with entries
[phase, np.array((z, x, z)), dict(metrics)]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.indexation_utils.index_magnitudes">
<code class="descclassname">pyxem.utils.indexation_utils.</code><code class="descname">index_magnitudes</code><span class="sig-paren">(</span><em>z</em>, <em>simulation</em>, <em>tolerance</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/indexation_utils.html#index_magnitudes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.indexation_utils.index_magnitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns hkl indices to peaks in the diffraction profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation</strong> (<em>DiffractionProfileSimulation</em>) – Simulation of the diffraction profile.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The n orientations with the highest correlation values are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>indexation</strong> – indexation results.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.indexation_utils.match_vectors">
<code class="descclassname">pyxem.utils.indexation_utils.</code><code class="descname">match_vectors</code><span class="sig-paren">(</span><em>peaks</em>, <em>library</em>, <em>mag_tol</em>, <em>angle_tol</em>, <em>index_error_tol</em>, <em>n_peaks_to_index</em>, <em>n_best</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/indexation_utils.html#match_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.indexation_utils.match_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns hkl indices to pairs of diffraction vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>peaks</strong> (<em>np.array</em><em>(</em><em>)</em>) – The experimentally measured diffraction vectors, associated with a
particular probe position, to be indexed. In Cartesian coordinates.</p></li>
<li><p><strong>library</strong> (<em>VectorLibrary</em>) – Library of reciprocal space vectors to be matched to the vectors.</p></li>
<li><p><strong>mag_tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Max allowed magnitude difference when comparing vectors.</p></li>
<li><p><strong>angle_tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Max allowed angle difference in radians when comparing vector pairs.</p></li>
<li><p><strong>index_error_tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Max allowed error in peak indexation for classifying it as indexed,
calculated as <span class="math notranslate nohighlight">\(|hkl_calculated - round(hkl_calculated)|\)</span>.</p></li>
<li><p><strong>n_peaks_to_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The maximum number of peak to index.</p></li>
<li><p><strong>n_best</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The maximum number of good solutions to be retained.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>indexation</strong> –</p>
<dl class="simple">
<dt>A numpy array containing the indexation results, each result consisting of 5 entries:</dt><dd><p>[phase index, rotation matrix, match rate, error hkls, total error]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyxem.utils.lobato_scattering_params">
<span id="pyxem-utils-lobato-scattering-params-module"></span><h2>pyxem.utils.lobato_scattering_params module<a class="headerlink" href="#module-pyxem.utils.lobato_scattering_params" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyxem.utils.peakfinder2D_gui">
<span id="pyxem-utils-peakfinder2d-gui-module"></span><h2>pyxem.utils.peakfinder2D_gui module<a class="headerlink" href="#module-pyxem.utils.peakfinder2D_gui" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIBase">
<em class="property">class </em><code class="descclassname">pyxem.utils.peakfinder2D_gui.</code><code class="descname">PeakFinderUIBase</code><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="attribute">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.current_method">
<code class="descname">current_method</code><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.current_method" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.get_data">
<code class="descname">get_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIBase.get_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.get_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.get_peaks">
<code class="descname">get_peaks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIBase.get_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.get_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.init_ui">
<code class="descname">init_ui</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIBase.init_ui"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.init_ui" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.interactive">
<code class="descname">interactive</code><span class="sig-paren">(</span><em>signal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIBase.interactive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIBase.interactive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW">
<em class="property">class </em><code class="descclassname">pyxem.utils.peakfinder2D_gui.</code><code class="descname">PeakFinderUIIPYW</code><span class="sig-paren">(</span><em>disc_image=None</em>, <em>imshow_kwargs={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIBase" title="pyxem.utils.peakfinder2D_gui.PeakFinderUIBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyxem.utils.peakfinder2D_gui.PeakFinderUIBase</span></code></a></p>
<p>Find peaks using a Jupyter notebook-based user interface</p>
<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_choices_widget">
<code class="descname">create_choices_widget</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.create_choices_widget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_choices_widget" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_navigator">
<code class="descname">create_navigator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.create_navigator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_navigator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_navigator_1d">
<code class="descname">create_navigator_1d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.create_navigator_1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_navigator_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_navigator_2d">
<code class="descname">create_navigator_2d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.create_navigator_2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_navigator_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_param_widget">
<code class="descname">create_param_widget</code><span class="sig-paren">(</span><em>param</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.create_param_widget"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_param_widget" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_param_widgets">
<code class="descname">create_param_widgets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.create_param_widgets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.create_param_widgets" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.init_ui">
<code class="descname">init_ui</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.init_ui"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.init_ui" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.plot_image">
<code class="descname">plot_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.plot_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.plot_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.plot_peaks">
<code class="descname">plot_peaks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.plot_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.plot_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.replot_image">
<code class="descname">replot_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.replot_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.replot_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.replot_peaks">
<code class="descname">replot_peaks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinder2D_gui.html#PeakFinderUIIPYW.replot_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinder2D_gui.PeakFinderUIIPYW.replot_peaks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyxem.utils.peakfinders2D">
<span id="pyxem-utils-peakfinders2d-module"></span><h2>pyxem.utils.peakfinders2D module<a class="headerlink" href="#module-pyxem.utils.peakfinders2D" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyxem.utils.peakfinders2D.clean_peaks">
<code class="descclassname">pyxem.utils.peakfinders2D.</code><code class="descname">clean_peaks</code><span class="sig-paren">(</span><em>peaks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinders2D.html#clean_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinders2D.clean_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to deal with no peaks being found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>peaks</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>numpy.ndarray</em></a>) – Result of peak finding</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>peaks</strong> (<em>numpy.ndarray</em>) – Result of peak finding</p></li>
<li><p><strong>NO_PEAKS</strong> (<em>string</em>) – Flag indicating no peaks found.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.peakfinders2D.find_peaks_dog">
<code class="descclassname">pyxem.utils.peakfinders2D.</code><code class="descname">find_peaks_dog</code><span class="sig-paren">(</span><em>z</em>, <em>min_sigma=1.0</em>, <em>max_sigma=50.0</em>, <em>sigma_ratio=1.6</em>, <em>threshold=0.2</em>, <em>overlap=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinders2D.html#find_peaks_dog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinders2D.find_peaks_dog" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds peaks via the difference of Gaussian Matrices method from
<cite>scikit-image</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>numpy.ndarray</em></a>) – 2-d array of intensities</p></li>
<li><p><strong>min_sigma</strong><strong>, </strong><strong>max_sigma</strong><strong>, </strong><strong>sigma_ratio</strong><strong>, </strong><strong>threshold</strong><strong>, </strong><strong>overlap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Additional parameters to be passed to the algorithm. See <cite>blob_dog</cite>
documentation for details:
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.feature.html#blob-dog">http://scikit-image.org/docs/dev/api/skimage.feature.html#blob-dog</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of peak coordinates of shape <cite>(n_peaks, 2)</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>While highly effective at finding even very faint peaks, this method is
sensitive to fluctuations in intensity near the edges of the image.</p>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.peakfinders2D.find_peaks_log">
<code class="descclassname">pyxem.utils.peakfinders2D.</code><code class="descname">find_peaks_log</code><span class="sig-paren">(</span><em>z</em>, <em>min_sigma=1.0</em>, <em>max_sigma=50.0</em>, <em>num_sigma=10.0</em>, <em>threshold=0.2</em>, <em>overlap=0.5</em>, <em>log_scale=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinders2D.html#find_peaks_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinders2D.find_peaks_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds peaks via the Laplacian of Gaussian Matrices method from
<cite>scikit-image</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>numpy.ndarray</em></a>) – Array of image intensities.</p></li>
<li><p><strong>min_sigma</strong><strong>, </strong><strong>max_sigma</strong><strong>, </strong><strong>num_sigma</strong><strong>, </strong><strong>threshold</strong><strong>, </strong><strong>overlap</strong><strong>, </strong><strong>log_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Additional parameters to be passed to the algorithm. See
<cite>blob_log</cite> documentation for details:
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.feature.html#blob-log">http://scikit-image.org/docs/dev/api/skimage.feature.html#blob-log</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(n_peaks, 2)
Array of peak coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.peakfinders2D.find_peaks_stat">
<code class="descclassname">pyxem.utils.peakfinders2D.</code><code class="descname">find_peaks_stat</code><span class="sig-paren">(</span><em>z</em>, <em>alpha=1.0</em>, <em>window_radius=10</em>, <em>convergence_ratio=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinders2D.html#find_peaks_stat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinders2D.find_peaks_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate positive peaks in an image based on statistical refinement and
difference with respect to mean intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>numpy.ndarray</em></a>) – Array of image intensities.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Only maxima above <cite>alpha * sigma</cite> are found, where <cite>sigma</cite> is the
local, rolling standard deviation of the image.</p></li>
<li><p><strong>window_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The pixel radius of the circular window for the calculation of the
rolling mean and standard deviation.</p></li>
<li><p><strong>convergence_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The algorithm will stop finding peaks when the proportion of new peaks
being found is less than <cite>convergence_ratio</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(n_peaks, 2)
Array of peak coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Implemented as described in the PhD thesis of Thomas White (2009) the
algorithm was developed by Gordon Ball during a summer project in
Cambridge.
This version by Ben Martineau (2016), with minor modifications to the
original where methods were ambiguous or unclear.</p>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.peakfinders2D.find_peaks_xc">
<code class="descclassname">pyxem.utils.peakfinders2D.</code><code class="descname">find_peaks_xc</code><span class="sig-paren">(</span><em>z</em>, <em>disc_image</em>, <em>min_distance=5</em>, <em>peak_threshold=0.2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinders2D.html#find_peaks_xc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinders2D.find_peaks_xc" title="Permalink to this definition">¶</a></dt>
<dd><p>Find peaks using the the correlation between the image and a reference peaks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>numpy.ndarray</em></a>) – Array of image intensities.</p></li>
<li><p><strong>disc_image</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>numpy.ndarray</em></a><em> (</em><em>square</em><em>)</em>) – Array containing a single bright disc, similar to those to detect.</p></li>
<li><p><strong>min_distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The minimum expected distance between peaks (in pixels)</p></li>
<li><p><strong>peak_threshold</strong> (<em>float between 0 and 1</em>) – Larger values will lead to fewer peaks in the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(n_peaks, 2)
Array of peak coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.peakfinders2D.find_peaks_zaefferer">
<code class="descclassname">pyxem.utils.peakfinders2D.</code><code class="descname">find_peaks_zaefferer</code><span class="sig-paren">(</span><em>z</em>, <em>grad_threshold=0.1</em>, <em>window_size=40</em>, <em>distance_cutoff=50.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/peakfinders2D.html#find_peaks_zaefferer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.peakfinders2D.find_peaks_zaefferer" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to locate positive peaks in an image based on gradient
thresholding and subsequent refinement within masked regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)"><em>numpy.ndarray</em></a>) – Matrix of image intensities.</p></li>
<li><p><strong>grad_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The minimum gradient required to begin a peak search.</p></li>
<li><p><strong>window_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The size of the square window within which a peak search is
conducted. If odd, will round down to even.</p></li>
<li><p><strong>distance_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The maximum distance a peak may be from the initial
high-gradient point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>peaks</strong> – (n_peaks, 2)
Peak pixel coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.16)">numpy.ndarray</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Implemented as described in Zaefferer “New developments of computer-aided
crystallographic analysis in transmission electron microscopy” J. Ap. Cryst.
This version by Ben Martineau (2016)</p>
</dd></dl>

</div>
<div class="section" id="module-pyxem.utils.plot">
<span id="pyxem-utils-plot-module"></span><h2>pyxem.utils.plot module<a class="headerlink" href="#module-pyxem.utils.plot" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyxem.utils.plot.generate_marker_inputs_from_peaks">
<code class="descclassname">pyxem.utils.plot.</code><code class="descname">generate_marker_inputs_from_peaks</code><span class="sig-paren">(</span><em>peaks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/plot.html#generate_marker_inputs_from_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.plot.generate_marker_inputs_from_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a peaks (defined in 2D) object from a STEM (more than 1 image) scan
and returns markers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>peaks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pyxem.diffraction_vectors.DiffractionVectors</span></code>) – Identifies peaks in a diffraction signal.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>How to get these onto images:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mmx</span><span class="p">,</span><span class="n">mmy</span> <span class="o">=</span> <span class="n">generate_marker_inputs_from_peaks</span><span class="p">(</span><span class="n">found_peaks</span><span class="p">)</span>
<span class="n">dp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">mx</span><span class="p">,</span><span class="n">my</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mmx</span><span class="p">,</span><span class="n">mmy</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">markers</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mx</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">my</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">dp</span><span class="o">.</span><span class="n">add_marker</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">plot_marker</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">permanent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyxem.utils.scattering_params">
<span id="pyxem-utils-scattering-params-module"></span><h2>pyxem.utils.scattering_params module<a class="headerlink" href="#module-pyxem.utils.scattering_params" title="Permalink to this headline">¶</a></h2>
<p>Scattering Paramaters as Tabulated in
“Advanced Computing in Electron Microscopy - Second Edition (2010) - Earl.J.Kirkland”
ISBN 978-1-4419-6532-5
Pages 253-260 Appendix C</p>
<p>This transcription comes from scikit-ued (MIT license) - <a class="reference external" href="https://pypi.python.org/pypi/scikit-ued">https://pypi.python.org/pypi/scikit-ued</a></p>
</div>
<div class="section" id="module-pyxem.utils.sim_utils">
<span id="pyxem-utils-sim-utils-module"></span><h2>pyxem.utils.sim_utils module<a class="headerlink" href="#module-pyxem.utils.sim_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyxem.utils.sim_utils.get_atomic_scattering_factors">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">get_atomic_scattering_factors</code><span class="sig-paren">(</span><em>g_hkl_sq</em>, <em>coeffs</em>, <em>scattering_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#get_atomic_scattering_factors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.get_atomic_scattering_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate atomic scattering factors for n atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g_hkl_sq</strong> (<em>ndarray</em>) – One-dimensional array of g-vector lengths squared.</p></li>
<li><p><strong>coeffs</strong> (<em>ndarray</em>) – Three-dimensional array [n, 5, 2] of coefficients corresponding to the n atoms.</p></li>
<li><p><strong>scattering_params</strong> (<em>string</em>) – Type of scattering factor calculation to use. One of ‘lobato’, ‘xtables’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scattering_factors</strong> – The calculated atomic scattering parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.get_electron_wavelength">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">get_electron_wavelength</code><span class="sig-paren">(</span><em>accelerating_voltage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#get_electron_wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.get_electron_wavelength" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the (relativistic) electron wavelength in Angstroms for a
given accelerating voltage in kV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>accelerating_voltage</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The accelerating voltage in kV.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>wavelength</strong> – The relativistic electron wavelength in Angstroms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.get_interaction_constant">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">get_interaction_constant</code><span class="sig-paren">(</span><em>accelerating_voltage</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#get_interaction_constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.get_interaction_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the interaction constant, sigma, for a given
acelerating voltage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>accelerating_voltage</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The accelerating voltage in V.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sigma</strong> – The relativistic electron wavelength in m.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.get_kinematical_intensities">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">get_kinematical_intensities</code><span class="sig-paren">(</span><em>structure</em>, <em>g_indices</em>, <em>g_hkls</em>, <em>excitation_error</em>, <em>maximum_excitation_error</em>, <em>debye_waller_factors</em>, <em>scattering_params='lobato'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#get_kinematical_intensities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.get_kinematical_intensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates peak intensities.</p>
<p>The peak intensity is a combination of the structure factor for a given
peak and the position the Ewald sphere intersects the relrod. In this
implementation, the intensity scales linearly with proximity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – The structure for which to derive the structure factors.</p></li>
<li><p><strong>indices</strong> (<em>array-like</em>) – The fractional coordinates of the peaks for which to calculate the
structure factor.</p></li>
<li><p><strong>proximities</strong> (<em>array-like</em>) – The distances between the Ewald sphere and the peak centers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>peak_intensities</strong> – The intensities of the peaks.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.get_points_in_sphere">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">get_points_in_sphere</code><span class="sig-paren">(</span><em>reciprocal_lattice</em>, <em>reciprocal_radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#get_points_in_sphere"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.get_points_in_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds all reciprocal lattice points inside a given reciprocal sphere.
Utilised within the DiffractionGenerator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reciprocal_lattice</strong> (<em>diffpy.Structure.Lattice</em>) – The crystal lattice for the structure of interest.
TODO: Mention that it is the reciprocal lattice. Just take the structure and calculate from there?</p></li>
<li><p><strong>reciprocal_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The radius of the sphere in reciprocal space (units of reciprocal
Angstroms) within which reciprocal lattice points are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>spot_indicies</strong> (<em>numpy.array</em>) – Miller indices of reciprocal lattice points in sphere.</p></li>
<li><p><strong>spot_coords</strong> (<em>numpy.array</em>) – Cartesian coordinates of reciprocal lattice points in sphere.</p></li>
<li><p><strong>spot_distances</strong> (<em>numpy.array</em>) – Distance of reciprocal lattice points in sphere from the origin.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.get_scattering_params_dict">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">get_scattering_params_dict</code><span class="sig-paren">(</span><em>scattering_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#get_scattering_params_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.get_scattering_params_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get scattering parameter dictionary from name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scattering_params</strong> (<em>string</em>) – Name of scattering factors. One of ‘lobato’, ‘xtables’.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scattering_params_dict</strong> – Dictionary of scattering parameters mapping from element name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.get_unique_families">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">get_unique_families</code><span class="sig-paren">(</span><em>hkls</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#get_unique_families"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.get_unique_families" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns unique families of Miller indices, which must be permutations of
each other.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hkls</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of Miller indices ([h, k, l])</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pretty_unique</strong> – A dict with unique hkl and multiplicity {hkl: multiplicity}.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.get_vectorized_list_for_atomic_scattering_factors">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">get_vectorized_list_for_atomic_scattering_factors</code><span class="sig-paren">(</span><em>structure</em>, <em>debye_waller_factors</em>, <em>scattering_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#get_vectorized_list_for_atomic_scattering_factors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.get_vectorized_list_for_atomic_scattering_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a flattened array of coeffs, fcoords and occus for vectorized
computation of atomic scattering factors.</p>
<p>Note: The dimensions of the returned objects are not necessarily the same
size as the number of atoms in the structure as each partially occupied
specie occupies its own position in the flattened array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>diffpy.structure</em>) – The atomic structure for which scattering factors are required.</p></li>
<li><p><strong>debye_waller_factors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of Debye-Waller factors for atoms in structure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>coeffs</strong> (<em>np.array()</em>) – Coefficients of atomic scattering factor parameterization for each atom.</p></li>
<li><p><strong>fcoords</strong> (<em>np.array()</em>) – Fractional coordinates of each atom in structure.</p></li>
<li><p><strong>occus</strong> (<em>np.array()</em>) – Occupancy of each atomic site.</p></li>
<li><p><strong>dwfactors</strong> (<em>np.array()</em>) – Debye-Waller factors for each atom in the structure.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.is_lattice_hexagonal">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">is_lattice_hexagonal</code><span class="sig-paren">(</span><em>latt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#is_lattice_hexagonal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.is_lattice_hexagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if a diffpy lattice is hexagonal or trigonal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>latt</strong> (<em>diffpy.Structure.lattice</em>) – The diffpy lattice object to be determined as hexagonal or not.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>is_true</strong> – True if hexagonal or trigonal.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.peaks_from_best_template">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">peaks_from_best_template</code><span class="sig-paren">(</span><em>single_match_result</em>, <em>library</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#peaks_from_best_template"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.peaks_from_best_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a TemplateMatchingResults object and return the associated peaks,
to be used in combination with map().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>single_match_result</strong> (<em>ndarray</em>) – An entry in a TemplateMatchingResults.</p></li>
<li><p><strong>library</strong> (<a class="reference internal" href="pyxem.libraries.html#pyxem.libraries.diffraction_library.DiffractionLibrary" title="pyxem.libraries.diffraction_library.DiffractionLibrary"><em>DiffractionLibrary</em></a>) – Diffraction library containing the phases and rotations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>peaks</strong> – Coordinates of peaks in the matching results object in calibrated units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.peaks_from_best_vector_match">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">peaks_from_best_vector_match</code><span class="sig-paren">(</span><em>single_match_result</em>, <em>library</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#peaks_from_best_vector_match"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.peaks_from_best_vector_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a VectorMatchingResults object and return the associated peaks,
to be used in combination with map().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>single_match_result</strong> (<em>ndarray</em>) – An entry in a VectorMatchingResults</p></li>
<li><p><strong>library</strong> (<a class="reference internal" href="pyxem.libraries.html#pyxem.libraries.diffraction_library.DiffractionLibrary" title="pyxem.libraries.diffraction_library.DiffractionLibrary"><em>DiffractionLibrary</em></a>) – Diffraction library containing the phases and rotations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>peaks</strong> – Coordinates of peaks in the matching results object in calibrated units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.rotation_list_stereographic">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">rotation_list_stereographic</code><span class="sig-paren">(</span><em>structure</em>, <em>corner_a</em>, <em>corner_b</em>, <em>corner_c</em>, <em>inplane_rotations</em>, <em>resolution</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#rotation_list_stereographic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.rotation_list_stereographic" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a rotation list covering the inverse pole figure specified by
three corners in cartesian coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>diffpy.structure.Structure</em>) – Structure for which to calculate the rotation list.</p></li>
<li><p><strong>corner_b</strong><strong>, </strong><strong>corner_c</strong> (<em>corner_a</em><em>,</em>) – The three corners of the inverse pole figure, each given by a
three-dimensional coordinate. The coordinate system is given by the
structure lattice.</p></li>
<li><p><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Angular resolution in radians of the generated rotation list.</p></li>
<li><p><strong>inplane_rotations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – <p>List of angles in radians for in-plane rotation of the diffraction
pattern. This corresponds to the third Euler angle rotation. The
rotation list will be generated for each of these angles, and combined.
This should be done automatically, but by including all possible
rotations in the rotation list, it becomes too large.</p>
<p>To cover all inplane rotations, use e.g. np.linspace(0, 2*np.pi, 360).</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rotation_list</strong> – Rotations covering the inverse pole figure given as an array of Euler
angles in degrees.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.simulate_kinematic_scattering">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">simulate_kinematic_scattering</code><span class="sig-paren">(</span><em>atomic_coordinates</em>, <em>element</em>, <em>accelerating_voltage</em>, <em>simulation_size=256</em>, <em>max_k=1.5</em>, <em>illumination='plane_wave'</em>, <em>sigma=20</em>, <em>scattering_params='lobato'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#simulate_kinematic_scattering"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.simulate_kinematic_scattering" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate electron scattering from arrangement of atoms comprising one
elemental species.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atomic_coordinates</strong> (<em>array</em>) – Array specifying atomic coordinates in structure.</p></li>
<li><p><strong>element</strong> (<em>string</em>) – Element symbol, e.g. “C”.</p></li>
<li><p><strong>accelerating_voltage</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Accelerating voltage in keV.</p></li>
<li><p><strong>simulation_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Simulation size, n, specifies the n x n array size for
the simulation calculation.</p></li>
<li><p><strong>max_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Maximum scattering vector magnitude in reciprocal angstroms.</p></li>
<li><p><strong>illumination</strong> (<em>string</em>) – Either ‘plane_wave’ or ‘gaussian_probe’ illumination</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Gaussian probe standard deviation, used when illumination == ‘gaussian_probe’</p></li>
<li><p><strong>scattering_params</strong> (<em>string</em>) – Type of scattering factor calculation to use. One of ‘lobato’, ‘xtables’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>simulation</strong> – ElectronDiffraction simulation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pyxem.signals.html#pyxem.signals.electron_diffraction.ElectronDiffraction" title="pyxem.signals.electron_diffraction.ElectronDiffraction">ElectronDiffraction</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.simulate_rotated_structure">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">simulate_rotated_structure</code><span class="sig-paren">(</span><em>diffraction_generator</em>, <em>structure</em>, <em>rotation_matrix</em>, <em>reciprocal_radius</em>, <em>with_direct_beam</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#simulate_rotated_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.simulate_rotated_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate electron diffraction data for a structure after rotating it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>diffraction_generator</strong> (<a class="reference internal" href="pyxem.generators.html#pyxem.generators.diffraction_generator.DiffractionGenerator" title="pyxem.generators.diffraction_generator.DiffractionGenerator"><em>DiffractionGenerator</em></a>) – Diffraction generator used to simulate diffraction patterns</p></li>
<li><p><strong>structure</strong> (<em>diffpy.structure.Structure</em>) – Structure object to simulate</p></li>
<li><p><strong>rotation_matrix</strong> (<em>ndarray</em>) – 3x3 matrix describing the base rotation to apply to the structure</p></li>
<li><p><strong>reciprocal_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The maximum g-vector magnitude to be included in the simulations.</p></li>
<li><p><strong>with_direct_beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Include the direct beam peak</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.transfer_navigation_axes">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">transfer_navigation_axes</code><span class="sig-paren">(</span><em>new_signal</em>, <em>old_signal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#transfer_navigation_axes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.transfer_navigation_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfers navigation axis calibrations from an old signal to a new
signal produced from it by a method or a generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_signal</strong> (<em>Signal</em>) – The product signal with undefined navigation axes.</p></li>
<li><p><strong>old_signal</strong> (<em>Signal</em>) – The parent signal with calibrated navigation axes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_signal</strong> – The new signal with calibrated navigation axes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Signal</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.transfer_navigation_axes_to_signal_axes">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">transfer_navigation_axes_to_signal_axes</code><span class="sig-paren">(</span><em>new_signal</em>, <em>old_signal</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#transfer_navigation_axes_to_signal_axes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.transfer_navigation_axes_to_signal_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Transfers navigation axis calibrations from an old signal to the signal
axes of a new signal produced from it by a method or a generator.</p>
<p>Used from methods that generate a signal with a single value at each
navigation position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_signal</strong> (<em>Signal</em>) – The product signal with undefined navigation axes.</p></li>
<li><p><strong>old_signal</strong> (<em>Signal</em>) – The parent signal with calibrated navigation axes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_signal</strong> – The new signal with calibrated signal axes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Signal</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.sim_utils.uvtw_to_uvw">
<code class="descclassname">pyxem.utils.sim_utils.</code><code class="descname">uvtw_to_uvw</code><span class="sig-paren">(</span><em>uvtw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/sim_utils.html#uvtw_to_uvw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.sim_utils.uvtw_to_uvw" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 4-index direction to a 3-index direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>uvtw</strong> (<em>array-like with 4 floats</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>uvw</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of 4 floats</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyxem.utils.subpixel_refinements_utils">
<span id="pyxem-utils-subpixel-refinements-utils-module"></span><h2>pyxem.utils.subpixel_refinements_utils module<a class="headerlink" href="#module-pyxem.utils.subpixel_refinements_utils" title="Permalink to this headline">¶</a></h2>
<p>utils to support SubpixelrefinementGenerator</p>
<dl class="function">
<dt id="pyxem.utils.subpixel_refinements_utils.get_experimental_square">
<code class="descclassname">pyxem.utils.subpixel_refinements_utils.</code><code class="descname">get_experimental_square</code><span class="sig-paren">(</span><em>z</em>, <em>vector</em>, <em>square_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/subpixel_refinements_utils.html#get_experimental_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.subpixel_refinements_utils.get_experimental_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a square region around a given diffraction vector and returns an
upsampled copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em><em>(</em><em>)</em>) – Single diffraction pattern</p></li>
<li><p><strong>vector</strong> (<em>np.array</em><em>(</em><em>)</em>) – Single vector in pixels (int) [x,y] with top left as [0,0]</p></li>
<li><p><strong>square_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The length of one side of the bounding square (must be even)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>square</strong> – Of size (L,L) where L = square_size</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.subpixel_refinements_utils.get_simulated_disc">
<code class="descclassname">pyxem.utils.subpixel_refinements_utils.</code><code class="descname">get_simulated_disc</code><span class="sig-paren">(</span><em>square_size</em>, <em>disc_radius</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/subpixel_refinements_utils.html#get_simulated_disc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.subpixel_refinements_utils.get_simulated_disc" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a uniform disc for correlating with the experimental square.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>square</em>) – (even) - size of the bounding box</p></li>
<li><p><strong>disc_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – radius of the disc</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>arr</strong> – Upsampled copy of the simulated disc as a numpy array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyxem.utils.vdf_utils">
<span id="pyxem-utils-vdf-utils-module"></span><h2>pyxem.utils.vdf_utils module<a class="headerlink" href="#module-pyxem.utils.vdf_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyxem.utils.vdf_utils.normalize_vdf">
<code class="descclassname">pyxem.utils.vdf_utils.</code><code class="descname">normalize_vdf</code><span class="sig-paren">(</span><em>im</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/vdf_utils.html#normalize_vdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.vdf_utils.normalize_vdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes image intensity by dividing by maximum value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>im</strong> (<em>np.array</em><em>(</em><em>)</em>) – Array of image intensities</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>imn</strong> – Array of normalized image intensities</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyxem.utils.vector_utils">
<span id="pyxem-utils-vector-utils-module"></span><h2>pyxem.utils.vector_utils module<a class="headerlink" href="#module-pyxem.utils.vector_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyxem.utils.vector_utils.calculate_norms">
<code class="descclassname">pyxem.utils.vector_utils.</code><code class="descname">calculate_norms</code><span class="sig-paren">(</span><em>z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/vector_utils.html#calculate_norms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.vector_utils.calculate_norms" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the norm of an array of cartesian vectors. For use with map().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>np.array</em><em>(</em><em>)</em>) – Array of cartesian vectors.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>norms</strong> – Array of vector norms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.vector_utils.calculate_norms_ragged">
<code class="descclassname">pyxem.utils.vector_utils.</code><code class="descname">calculate_norms_ragged</code><span class="sig-paren">(</span><em>z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/vector_utils.html#calculate_norms_ragged"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.vector_utils.calculate_norms_ragged" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the norm of an array of cartesian vectors. For use with map()
when applied to a ragged array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>np.array</em><em>(</em><em>)</em>) – Array of cartesian vectors.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>norms</strong> – Array of vector norms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.vector_utils.detector_to_fourier">
<code class="descclassname">pyxem.utils.vector_utils.</code><code class="descname">detector_to_fourier</code><span class="sig-paren">(</span><em>k_xy</em>, <em>wavelength</em>, <em>camera_length</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/vector_utils.html#detector_to_fourier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.vector_utils.detector_to_fourier" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps two-dimensional Cartesian coordinates in the detector plane to
three-dimensional coordinates in reciprocal space, with origo in [000].</p>
<p>The detector uses a left-handed coordinate system, while the reciprocal
space uses a right-handed coordinate system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_xy</strong> (<em>np.array</em><em>(</em><em>)</em>) – Cartesian coordinates in detector plane, in reciprocal Ångström.</p></li>
<li><p><strong>wavelength</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Electron wavelength in Ångström.</p></li>
<li><p><strong>camera_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Camera length in metres.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>k</strong> – Array of Cartesian coordinates in reciprocal space relative to [000].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.vector_utils.get_angle_cartesian">
<code class="descclassname">pyxem.utils.vector_utils.</code><code class="descname">get_angle_cartesian</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/vector_utils.html#get_angle_cartesian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.vector_utils.get_angle_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the angle between two vectors in a cartesian coordinate system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>b</strong> (<em>a</em><em>,</em>) – The two directions to compute the angle between.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>angle</strong> – Angle between <cite>a</cite> and <cite>b</cite> in radians.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.vector_utils.get_indices_from_distance_matrix">
<code class="descclassname">pyxem.utils.vector_utils.</code><code class="descname">get_indices_from_distance_matrix</code><span class="sig-paren">(</span><em>distances</em>, <em>distance_threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/vector_utils.html#get_indices_from_distance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.vector_utils.get_indices_from_distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the distances from one vector in vlist to all other vectors in
vlist are larger than distance_threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distances</strong> (<em>np.array</em><em>(</em><em>)</em>) – Array of distances between vectors.</p></li>
<li><p><strong>distance_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The distance threshold for a vector to be retained.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_indices</strong> – Array of vectors with distances greater than the threshold.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.vector_utils.get_npeaks">
<code class="descclassname">pyxem.utils.vector_utils.</code><code class="descname">get_npeaks</code><span class="sig-paren">(</span><em>found_peaks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/vector_utils.html#get_npeaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.vector_utils.get_npeaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of entries in a list. For use with map().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>found_peaks</strong> (<em>np.array</em><em>(</em><em>)</em>) – Array of found peaks.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>len</strong> – The number of peaks in the array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyxem.utils.vector_utils.get_rotation_matrix_between_vectors">
<code class="descclassname">pyxem.utils.vector_utils.</code><code class="descname">get_rotation_matrix_between_vectors</code><span class="sig-paren">(</span><em>k1</em>, <em>k2</em>, <em>ref_k1</em>, <em>ref_k2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyxem/utils/vector_utils.html#get_rotation_matrix_between_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyxem.utils.vector_utils.get_rotation_matrix_between_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the rotation matrix to two experimentally measured
diffraction vectors from the corresponding vectors in a reference structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k1</strong> (<em>np.array</em><em>(</em><em>)</em>) – Experimentally measured scattering vector 1.</p></li>
<li><p><strong>k2</strong> (<em>np.array</em><em>(</em><em>)</em>) – Experimentally measured scattering vector 2.</p></li>
<li><p><strong>ref_k1</strong> (<em>np.array</em><em>(</em><em>)</em>) – Reference scattering vector 1.</p></li>
<li><p><strong>ref_k2</strong> (<em>np.array</em><em>(</em><em>)</em>) – Reference scattering vector 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>R</strong> – Rotation matrix describing transformation from experimentally measured
scattering vectors to equivalent reference vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array()</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyxem.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyxem.utils" title="Permalink to this headline">¶</a></h2>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright Copyright 2017-2019, Python Crystallographic Electron Microscopy.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>